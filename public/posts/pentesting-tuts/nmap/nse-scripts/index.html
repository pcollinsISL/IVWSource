<!DOCTYPE html>



 <html class="no-js"> 
<head>
    <title>Nmap - NSE Scripts  &middot; KCSEC </title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta http-equiv="content-language" content="en-us" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="author" content="K.C">
    <meta name="description" content="KSEC Security Blog">
    <meta name="generator" content="Hugo 0.24.1" />

    <!-- Stylesheets -->
    <link rel="stylesheet" href="https://www.ivoidwarranties.tech/css/smooth-scrollbar.css" />
    <link rel="stylesheet" type="text/css" href="https://www.ivoidwarranties.tech/css/main.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/styles/tomorrow.min.css" />
    

    <style>
        .posts li {
            visibility: hidden;
        }
    </style> 
</head>
<body>
    
    

    <header>	
	<div class="h-wrap">
		
		<h1 class="title"><a href="https://www.ivoidwarranties.tech/">KCSEC</a></h1>
		
	</div>
</header>
    
    <div class="site-wrapper" id="full-wrapper">
        
        <section class="single-wrap">
            <article class="single-content" itemscope itemtype="//schema.org/BlogPosting">
                <div class="feat">
                    <h5 class="page-date">
                    <time datetime="" itemprop="datePublished">
                    09 October 2223
                   
                    </time>
                    </h5>
                </div>
                <h1 class="page-title" itemprop="name headline">Nmap - NSE Scripts</h1>
                <div itemprop="articleBody">
                    

<p>Get help for a script</p>

<pre><code>nmap --script-help=ssl-heartbleed
</code></pre>

<p>updating scripts</p>

<pre><code>nmap --script-updatedb
</code></pre>

<p>Location and finding of scripts</p>

<pre><code>Locate *.nse     - Will find all NSE Scripts on machine
/user/share/nmap/scripts/      -Default script location
</code></pre>

<p><img src="/img/Nmap/NSESL.PNG" alt="Nmap" /></p>

<h3 id="top-scripts">Top Scripts</h3>

<p>SMB subnet discovery</p>

<pre><code>nmap -sS -sV --script smb-enum-shares.nse,smb-os-discovery.nse -p445,139 192.168.1.0/24
</code></pre>

<p>Dump SAM database remotely</p>

<pre><code>nmap -p 135,139,445 --script smb-pwdump --script-args-smbuser=USERNAME,smbpass=PASSWORD &lt;Target&gt;
</code></pre>

<p><img src="http://boreditguy.com/blog/wp-content/uploads/2010/09/nmap_scripts1-1024x352.png" alt="Nmap" /></p>

<p>Nmap NSE script to detect MS17-010 vuln used by WannaCry - <a href="https://github.com/cldrn/nmap-nse-scripts/blob/master/scripts/smb-vuln-ms17-010.nse">Download</a></p>

<pre><code>nmap -v --script smb-vuln-ms17-010 -p445 &lt;target&gt;
</code></pre>

<p><img src="https://securityonline.info/wp-content/uploads/2017/05/C_2XBTZU0AAoBCo.jpg" alt="Nmap" /></p>

<p>Scan with all smb NSE scripts</p>

<pre><code>nmap -sV --script smb* &lt;Target&gt;
</code></pre>

<p>Scan with all MS SQL NSE scripts</p>

<pre><code>nmap -sV --script ms-sql* &lt;Target&gt;
</code></pre>

<p>Scan with all MYSQL NSE scripts</p>

<pre><code>nmap -sV --script mysql* &lt;Target&gt;
</code></pre>

<p>Scan with all HTTP NSE scripts (Messy)</p>

<pre><code>nmap -sV --script http* &lt;Target&gt;
</code></pre>

<h4 id="http-nse-scripts">Http NSE scripts</h4>

<p>Detect Heartbleed SSL Vulnerability</p>

<pre><code>nmap -sV -p 443 –script=ssl-heartbleed.nse &lt;Target&gt;
</code></pre>

<p>Gather page titles from HTTP services</p>

<pre><code>nmap --script http-title &lt;Target&gt;
</code></pre>

<p>Get HTTP headers of web services</p>

<pre><code>nmap --script http-headers &lt;Target&gt;
</code></pre>

<p>Http Enumeration - Find web apps from known paths</p>

<pre><code>nmap --script http-enum &lt;Target&gt;
</code></pre>

<p>Http Sitemap Generator</p>

<pre><code>nmap --script http-sitemap-generator &lt;target&gt; &lt;port&gt;
</code></pre>

<p><img src="https://securityonline.info/wp-content/uploads/2016/11/Screenshot-from-2016-11-11-14-03-07.png" alt="Nmap" /></p>

<p>http Methods</p>

<pre><code>nmap --script http-methods &lt;target&gt;
</code></pre>

<p><img src="https://securityonline.info/wp-content/uploads/2016/11/Screenshot-from-2016-11-11-14-05-52.png" alt="Nmap" /></p>

<h4 id="smb-nse-scripts">SMB NSE Scripts</h4>

<p>Enumerate SMB shares</p>

<pre><code>nmap --script smb-enum-shares &lt;Target&gt;
</code></pre>

<p>Enumerate SMB Users</p>

<pre><code>nmap --script smb-enum-users &lt;Target&gt;
</code></pre>

<p>Brute force SMB service with password list</p>

<pre><code>nmap --script smb-brute -p445 &lt;Target&gt;
</code></pre>

<p>Brute force SMB service with hashes (Hashes and usernames kept in .txt files)</p>

<pre><code>nmap --script smb-brute --script-args=userdb=usernames.txt,passdb=passwords.txt &lt;Target&gt;
</code></pre>

<p>Discover SMB OS</p>

<pre><code>nmap --script smb-os-discovery &lt;Target&gt;
</code></pre>

<p>Dump hashes remotely - Needs valid credentials</p>

<pre><code>nmap -p 135,139,445 --script smb-pwdump --script-args-smbuser=USERNAME,smbpass=PASSWORD &lt;Target&gt;
</code></pre>

<p>Shows logged in sessions - Needs valid credentials</p>

<pre><code>nmap --script smb-enum-sessions -p445  &lt;Target&gt;
</code></pre>

<h4 id="sql-servers">SQL Servers</h4>

<p>MSSQL Server info</p>

<pre><code>nmap -p1433 --script ms-sql-info &lt;Target&gt;
</code></pre>

<p><img src="https://pentestlab.files.wordpress.com/2013/04/screenshot.png" alt="Nmap" /></p>

<p>MSSQL - Bruteforce</p>

<pre><code>nmap -p1433 --script ms-sql-brute &lt;Target&gt;
</code></pre>

<p><img src="https://pentestlab.files.wordpress.com/2013/04/screenshot1.png" alt="Nmap" /></p>

<p>MSSQL - Bruteforce With custom list</p>

<pre><code>nmap -p1433 –script ms-sql-brute –script-args userdb=/var/usernames.txt,passdb=/var/passwords.txt &lt;target&gt;
</code></pre>

<p>MSSQL - Bruteforce With empty/null password</p>

<pre><code>nmap -p1443 --script ms-sql-empty-password &lt;Target&gt;
</code></pre>

<p><img src="https://pentestlab.files.wordpress.com/2013/04/screenshot-1.png" alt="Nmap" /></p>

<p>MSSQL - Discover which user has access to which db (Credentials Needed)</p>

<pre><code>nmap -p1443 --script ms-sql-haddbaccess --script-args mssql.username=USERNAME &lt;target&gt;
</code></pre>

<p><img src="https://pentestlab.files.wordpress.com/2013/04/screenshot2.png" alt="Nmap" /></p>

<p>MSSQL - List Tables (Credentials Needed)</p>

<pre><code>nmap -p1443 --script ms-sql-tables --script-args mssql.username=USERNAME &lt;Target&gt;
</code></pre>

<p><img src="https://pentestlab.files.wordpress.com/2013/04/screenshot-11.png" alt="Nmap" /></p>

<p>MSSQL - SQL Server xp_cmdshell (Run OS command via xp_cmdshell)
This will just print the CMD output default (Ipconfig)</p>

<pre><code>nmap -p1433 --script ms-sql-xp-cmdshell --script-args mssql.username=USERNAME &lt;Target&gt;
</code></pre>

<p><img src="https://pentestlab.files.wordpress.com/2013/04/screenshot-2.png" alt="Nmap" /></p>

<p>To Specify the command to use you need to us the arg  &ldquo;&ndash;script-args=ms-sql-xp-cmdshell.cmd=&lsquo;COMMAND&rsquo;&rdquo;
As shown as an example bellow</p>

<pre><code>nmap -p1433 --script ms-sql-xp-cmdshell --script-args=ms-sql-xp-cmdshell.cmd='net users',mssql.username=USERNAME &lt;Target&gt;
</code></pre>

<p><img src="https://pentestlab.files.wordpress.com/2013/04/screenshot-3.png" alt="Nmap" /></p>

<h4 id="recon">Recon</h4>

<p>Find Information about IP address</p>

<pre><code>nmap --traceroute --script traceroute-geolocation.nse -p 80 &lt;Target&gt;
</code></pre>

<p><img src="https://securityonline.info/wp-content/uploads/2016/11/Screenshot-from-2016-11-11-13-50-33.png" alt="Nmap" /></p>

<p>DNS Brute Force</p>

<pre><code>nmap -p 80 --script dns-brute.nse &lt;Target&gt;
</code></pre>

<p><img src="https://securityonline.info/wp-content/uploads/2016/11/Screenshot-from-2016-11-11-13-46-43.png" alt="Nmap" /></p>

<p>Find Hosts on IP</p>

<pre><code>nmap -p 80 --script hostmap-bfk.nse &lt;Target&gt;
</code></pre>

<p>Firewalk - Tries to discover firewall rules using an IP TTL expiration technique.</p>

<pre><code>nmap --script firewalk --traceroute --script-args=firewalk.max-retries=1 &lt;Target&gt;
</code></pre>

<p><img src="https://securityonline.info/wp-content/uploads/2016/11/Screenshot-from-2016-11-11-13-57-22.png" alt="Nmap" /></p>

<p>whois domain</p>

<pre><code>nmap --script whois-domain &lt;target&gt;
</code></pre>

<p><img src="https://securityonline.info/wp-content/uploads/2016/11/Screenshot-from-2016-11-11-14-13-37.png" alt="Nmap" /></p>

<p>Shodan API - API Key can be specieid in args or by editing the NSE script itself (Shown in video)</p>

<pre><code>nmap --script shodan-api --script-args 'shodan-api.target=x.y.z.a,shodan-api.apikey=SHODANAPIKEY'
</code></pre>

<iframe width="650" height="400"src="https://www.youtube.com/embed/WaLrqyNCC8o" frameborder="0" allowfullscreen></iframe>

<h3 id="custom-nse-script-repositories">Custom NSE Script repositories</h3>

<p>Paulino Calderon (cldrn) -
Network security specialist | Open Source contributor | @nmap NSE developer | Chapter leader of @owasp_riviera</p>

<pre><code>https://github.com/cldrn/nmap-nse-scripts/tree/master/scripts
</code></pre>

<p>John Bond -
b4ldr <a href="https://www.linkedin.com/in/john-bond-189887a/">https://www.linkedin.com/in/john-bond-189887a/</a></p>

<pre><code>https://github.com/b4ldr/nse-scripts
</code></pre>

<p>Peter -
peter-hackertarget  <a href="https://hackertarget.com">https://hackertarget.com</a></p>

<pre><code>https://github.com/peter-hackertarget/nmap-nse-scripts
</code></pre>

<p>Sanoop Thomas -
s4n7h0 &ldquo; Let the passion be your purpose. &rdquo; Security guy, Researcher, Speaker, Creator of Halcyon IDE</p>

<pre><code>https://github.com/s4n7h0/NSE
</code></pre>

<p>Aeris Secure -
Open source projects from Aeris Secure, mostly relating to information security and security testing</p>

<pre><code>https://github.com/aerissecure/nse
</code></pre>
                    
                </div>
                <div class="feat share">
                </div>
                
                <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'kcivwdq';
    var disqus_identifier = 'https:\/\/www.ivoidwarranties.tech\/posts\/pentesting-tuts\/nmap\/nse-scripts\/';
    var disqus_title = 'Nmap - NSE Scripts';
    var disqus_url = 'https:\/\/www.ivoidwarranties.tech\/posts\/pentesting-tuts\/nmap\/nse-scripts\/';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
                
            </article>
        </section>

        <footer>
	
	<small>KCSEC</small>
	
</footer>
    </div>

    <div class="next-prev-arrows">
        
            <a rel="next" href="https://www.ivoidwarranties.tech/posts/pentesting-tuts/nmap/cheatsheet/" id="next">
                &larr; <span class="nav-title nav-title-next">Nmap - Cheatsheet</span> 
            </a>
        
        
            <a rel="prev" href="https://www.ivoidwarranties.tech/posts/pentesting-tuts/netcat/cheatsheet/" id="prev">
                 <span class="nav-title nav-title-prev">NetCat CheatSheet</span> &rarr;
            </a>
        
    </div>

    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="https://www.ivoidwarranties.tech/js/scrollreveal.min.js"></script>
<script type='application/javascript' src='https://www.ivoidwarranties.tech/js/smooth-scrollbar.js'></script>
<script src="https://www.ivoidwarranties.tech/js/baffle.min.js"></script>
<script src="https://www.ivoidwarranties.tech/js/main.js"></script>



<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-103162154-1', 'auto');
ga('send', 'pageview');
</script>



<!-- Syntax highlighting -->
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</body>
</html>
