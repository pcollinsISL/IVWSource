<!DOCTYPE html>



 <html class="no-js"> 
<head>
    <title>Nmap - Cheatsheet  &middot; KCSEC </title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta http-equiv="content-language" content="en-us" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="author" content="K.C">
    <meta name="description" content="KSEC Security Blog">
    <meta name="generator" content="Hugo 0.24.1" />

    <!-- Stylesheets -->
    <link rel="stylesheet" href="https://www.ivoidwarranties.tech/css/smooth-scrollbar.css" />
    <link rel="stylesheet" type="text/css" href="https://www.ivoidwarranties.tech/css/main.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/styles/tomorrow.min.css" />
    

    <style>
        .posts li {
            visibility: hidden;
        }
    </style> 
</head>
<body>
    
    

    <header>	
	<div class="h-wrap">
		
		<h1 class="title"><a href="https://www.ivoidwarranties.tech/">KCSEC</a></h1>
		
	</div>
</header>
    
    <div class="site-wrapper" id="full-wrapper">
        
        <section class="single-wrap">
            <article class="single-content" itemscope itemtype="//schema.org/BlogPosting">
                <div class="feat">
                    <h5 class="page-date">
                    <time datetime="" itemprop="datePublished">
                    17 October 2223
                   
                    </time>
                    </h5>
                </div>
                <h1 class="page-title" itemprop="name headline">Nmap - Cheatsheet</h1>
                <div itemprop="articleBody">
                    

<h3 id="nmap-nikto-scan">Nmap Nikto Scan</h3>

<p>Scans for http (Web) servers on port 80 and pipes into Nikto for scanning.</p>

<pre><code>nmap -p80 10.0.1.0/24 -oG - | nikto.pl -h -
</code></pre>

<p>Scans for http/https servers on port 80 &amp; 443 and pipes into Nikto.</p>

<pre><code>nmap -p80,443 10.0.1.0/24 -oG - | nikto.pl -h -
</code></pre>

<p><img src="/img/Nmap/nmapP443nikto4.PNG" alt="Nmap" /></p>

<h3 id="target-specification">Target Specification</h3>

<p>Nmap is able to use hostnames, IP addresses and subnets.</p>

<pre><code>nmap www.company.domain.com  
nmap 192.168.1.1 
nmap 10.0.0-255.1-254
</code></pre>

<p><img src="/img/Nmap/nmapIP.PNG" alt="Nmap" /></p>

<p>Target Specific settings</p>

<pre><code>-iL            inputfilename: Input from list of hosts/networks
-iR            num hosts: Choose random targets
--exclude      host1[,host2][,host3],... : Exclude hosts/networks
--excludefile  exclude_file: Exclude list from file
</code></pre>

<h3 id="host-discovery">Host Discovery</h3>

<pre><code>-sL                       List Scan - simply list targets to scan
-sn                       Ping Scan - disable port scan
-Pn                       Treat all hosts as online -- skip host discovery
-PS/PA/PU/PY[portlist]    TCP SYN/ACK, UDP or SCTP discovery to given ports
-PE/PP/PM                 ICMP echo, timestamp, and netmask request discovery probes
-PO[protocol list]        IP Protocol Ping
-n/-R                     Never do DNS resolution/Always resolve [default: sometimes]
</code></pre>

<p><img src="/img/Nmap/nmapIPsn.PNG" alt="Nmap" /></p>

<h3 id="scan-techniques">Scan Techniques</h3>

<pre><code>-sS            TCP SYN scan
-sT            Connect scan
-sA            ACK scan
-sW            Window scan
-sM            Maimon scan

-sU            UDP Scan

-sN            TCP Null scan
-sF            FIN scan
-sX            Xmas scan

--scanflags                  Customize TCP scan flags
-sI zombie host[:probeport]  Idle scan

-sY            SCTP INIT scan
-sZ            COOKIE-ECHO scan

-sO            IP protocol scan

 -b &quot;FTP relay host&quot;  FTP bounce scan
</code></pre>

<h3 id="port-specification-and-scan-order">Port Specification and Scan Order</h3>

<pre><code>-p                     Specify ports, e.g. -p80,443 or -p1-65535
-p U:PORT              Scan UDP ports with Nmap, e.g. -p U:53
-F                     Fast mode, scans fewer ports than the default scan
-r                     Scan ports consecutively - don't randomize
--top-ports &quot;number&quot;   Scan &quot;number&quot; most common ports
--port-ratio &quot;ratio&quot;   Scan ports more common than &quot;ratio&quot;

</code></pre>

<h3 id="service-version-detection">Service Version Detection</h3>

<pre><code>-sV                            Probe open ports to determine service/version info
--version-intensity &quot;level&quot;    Set from 0 (light) to 9 (try all probes)
--version-light                Limit to most likely probes (intensity 2)
--version-all                  Try every single probe (intensity 9)
--version-trace                Show detailed version scan activity (for debugging)
</code></pre>

<p><img src="/img/Nmap/nmapIPsv.PNG" alt="Nmap" /></p>

<h3 id="script-scan">Script Scan</h3>

<pre><code>-sC                                equivalent to --script=default
--script=&quot;ssl-heartbleed&quot;         &quot;ssl-heartbleed&quot; Is the selected script 
--script-args=n1=v1,[n2=v2,...]    provide arguments to scripts
-script-args-file=filename         provide NSE script args in a file
--script-trace                     Show all data sent and received
--script-updatedb                  Update script database
--script-help=&quot;ssl-heartbleed&quot;     Show help about scripts
</code></pre>

<p><img src="/img/Nmap/nmapNSEHB.PNG" alt="Nmap" /></p>

<h3 id="os-detection">OS Detection</h3>

<pre><code>-O                 Enable OS Detection
--osscan-limit     Limit OS detection to promising targets
--osscan-guess     Guess OS more aggressively
</code></pre>

<p><img src="/img/Nmap/nmapIPO.PNG" alt="Nmap" /></p>

<h3 id="firewalls-ids-evasion-and-spoofing">Firewalls IDS Evasion and Spoofing</h3>

<pre><code>-f; --mtu VALUE           Fragment packets (optionally w/given MTU)
-D decoy1,decoy2,ME       Cloak a scan with decoys
-S IP-ADDRESS             Spoof source address
-e IFACE                  Use specified interface

-g PORTNUM                Use given port number
--source-port PORTNUM    
 
--proxies url1,[url2],... Relay connections through HTTP / SOCKS4 proxies
--data-length NUM         Append random data to sent packets
--ip-options OPTIONS      Send packets with specified ip options
--ttl VALUE                     Set IP time to live field
--spoof-mac ADDR/PREFIX/VENDOR  Spoof NMAP MAC address
--badsum                  Send packets with a bogus TCP/UDP/SCTP checksum
</code></pre>

<h3 id="nmap-output-options">Nmap Output Options</h3>

<pre><code>-oN                       Output Normal
-oX                       Output to XML
-oS                       Script Kiddie / 1337 speak... sigh
-oG                       Output greppable - easy to grep nmap output
-oA BASENAME              Output in the three major formats at once
-v                        Increase verbosity level use -vv or more for greater effect
-d                        Increase debugging level use -dd or more for greater effect
--reason                  Display the reason a port is in a particular state
--open                    Only show open or possibly open ports
--packet-trace            Show all packets sent / received
--iflist                  Print host interfaces and routes for debugging
--log-errors              Log errors/warnings to the normal-format output file
--append-output           Append to rather than clobber specified output files
--resume FILENAME         Resume an aborted scan
--stylesheet PATH/URL     XSL stylesheet to transform XML output to HTML
--webxml                  Reference stylesheet from Nmap.Org for more portable XML
--no-stylesheet           Prevent associating of XSL stylesheet w/XML output
</code></pre>
                    
                </div>
                <div class="feat share">
                </div>
                
                <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'kcivwdq';
    var disqus_identifier = 'https:\/\/www.ivoidwarranties.tech\/posts\/pentesting-tuts\/nmap\/cheatsheet\/';
    var disqus_title = 'Nmap - Cheatsheet';
    var disqus_url = 'https:\/\/www.ivoidwarranties.tech\/posts\/pentesting-tuts\/nmap\/cheatsheet\/';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
                
            </article>
        </section>

        <footer>
	
	<small>KCSEC</small>
	
</footer>
    </div>

    <div class="next-prev-arrows">
        
            <a rel="next" href="https://www.ivoidwarranties.tech/posts/pentesting-tuts/nmap/master/" id="next">
                &larr; <span class="nav-title nav-title-next">Nmap</span> 
            </a>
        
        
            <a rel="prev" href="https://www.ivoidwarranties.tech/posts/pentesting-tuts/nmap/nse-scripts/" id="prev">
                 <span class="nav-title nav-title-prev">Nmap - NSE Scripts</span> &rarr;
            </a>
        
    </div>

    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="https://www.ivoidwarranties.tech/js/scrollreveal.min.js"></script>
<script type='application/javascript' src='https://www.ivoidwarranties.tech/js/smooth-scrollbar.js'></script>
<script src="https://www.ivoidwarranties.tech/js/baffle.min.js"></script>
<script src="https://www.ivoidwarranties.tech/js/main.js"></script>



<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-103162154-1', 'auto');
ga('send', 'pageview');
</script>



<!-- Syntax highlighting -->
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</body>
</html>
