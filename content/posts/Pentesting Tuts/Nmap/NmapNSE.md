+++
title = "Nmap - NSE Scripts"
description = "Nmap NSE Scripts"
tags = [ "Nmap", "NSE Scripts, Easy", "Master" ]
date = "2223-10-09"
location = "127.0.0.1"
categories = ["Nmap","Scripts"]
slug = "NSE-Scripts"
type = "post"
+++




Get help for a script	
```
nmap --script-help=ssl-heartbleed
 ```
 
 updating scripts
```
nmap --script-updatedb
```
 
Location and finding of scripts

```
Locate *.nse     - Will find all NSE Scripts on machine
/user/share/nmap/scripts/      -Default script location
```
![Nmap](/img/Nmap/NSESL.PNG)



 
 
 
 
 
 
### Top Scripts 


SMB subnet discovery
```
nmap -sS -sV --script smb-enum-shares.nse,smb-os-discovery.nse -p445,139 192.168.1.0/24
```


Dump SAM database remotely
```
nmap -p 135,139,445 --script=smb-pwdump --script-args-smbuser=USERNAME,smbpass=PASSWORD <Target>
```
![Nmap](http://boreditguy.com/blog/wp-content/uploads/2010/09/nmap_scripts1-1024x352.png)


Nmap NSE script to detect MS17-010 vuln used by WannaCry - [Download] (https://github.com/cldrn/nmap-nse-scripts/blob/master/scripts/smb-vuln-ms17-010.nse)
```
nmap -v --script smb-vuln-ms17-010 -p445 <target>
```
![Nmap](https://securityonline.info/wp-content/uploads/2017/05/C_2XBTZU0AAoBCo.jpg)



#### Http NSE scripts


Detect Heartbleed SSL Vulnerability	
```
nmap -sV -p 443 –script=ssl-heartbleed.nse <Target>
```

Gather page titles from HTTP services	
```
nmap --script=http-title <Target>
```

Get HTTP headers of web services	
```
nmap --script=http-headers <Target>
```

Http Enumeration - Find web apps from known paths	
```
nmap --script=http-enum <Target>
```

Http Sitemap Generator
```
nmap --script http-sitemap-generator <target> <port>
```
![Nmap](https://securityonline.info/wp-content/uploads/2016/11/Screenshot-from-2016-11-11-14-03-07.png)


http Methods
```
nmap --script http-methods <target>
```

![Nmap](https://securityonline.info/wp-content/uploads/2016/11/Screenshot-from-2016-11-11-14-05-52.png)


#### SMB NSE Scripts

Enumerate SMB shares
```
nmap --script=smb-enum-shares <Target>
```
Enumerate SMB Users
```
nmap --script=smb-enum-users <Target>
```
Brute force SMB service with password list
```
nmap --script=smb-brute -p445 <Target>
```
Brute force SMB service with hashes (Hashes and usernames kept in .txt files)
```
nmap --script=smb-brute --script-args=userdb=usernames.txt,passdb=passwords.txt <Target>
```

Discover SMB OS
```
nmap --script=smb-os-discovery <Target>
```

Dump hashes remotely - Needs valid credentials 
```
nmap -p 135,139,445 --script=smb-pwdump --script-args-smbuser=USERNAME,smbpass=PASSWORD <Target>
```

Shows logged in sessions - Needs valid credentials
```
nmap --script smb-enum-sessions -p445  <Target>
```

Scan with a set of scripts	
```
nmap -sV --script=smb* 192.168.1.1
```

#### SQL Servers

MSSQL Server info
```
nmap -p1433 --script ms-sql-info <Target>
```
![Nmap](https://pentestlab.files.wordpress.com/2013/04/screenshot.png)




MSSQL - Bruteforce
```
nmap -p1433 --script ms-sql-brute <Target>
```
![Nmap](https://pentestlab.files.wordpress.com/2013/04/screenshot1.png)



MSSQL - Bruteforce With custom list
```
nmap -p1433 –script ms-sql-brute –script-args userdb=/var/usernames.txt,passdb=/var/passwords.txt <target>
```

MSSQL - Bruteforce With empty/null password
```
nmap -p1443 --script ms-sql-empty-password <Target>
```
![Nmap](https://pentestlab.files.wordpress.com/2013/04/screenshot-1.png)


MSSQL - Discover which user has access to which db (Credentials Needed)
```
nmap -p1443 --script ms-sql-haddbaccess --script-args mssql.username=USERNAME <target>
```
![Nmap](https://pentestlab.files.wordpress.com/2013/04/screenshot2.png)


MSSQL - List Tables (Credentials Needed)
```
nmap -p1443 --script ms-sql-tables --script-args mssql.username=USERNAME <Target>
```
![Nmap](https://pentestlab.files.wordpress.com/2013/04/screenshot-11.png)


MSSQL - SQL Server xp_cmdshell (Run OS command via xp_cmdshell) 
This will just print the CMD output default (Ipconfig)
```
nmap -p1433 --script ms-sql-xp-cmdshell --script-args mssql.username=USERNAME <Target>
```
![Nmap](https://pentestlab.files.wordpress.com/2013/04/screenshot-2.png)

To Specify the command to use you need to us the arg  "--script-args=ms-sql-xp-cmdshell.cmd='COMMAND'"
As shown as an example bellow

```
nmap -p1433 --script ms-sql-xp-cmdshell --script-args=ms-sql-xp-cmdshell.cmd='net users',mssql.username=USERNAME <Target>
```
![Nmap](https://pentestlab.files.wordpress.com/2013/04/screenshot-3.png)







#### Recon

Find Information about IP address
```
nmap --traceroute --script traceroute-geolocation.nse -p 80 <Target>
```
![Nmap](https://securityonline.info/wp-content/uploads/2016/11/Screenshot-from-2016-11-11-13-50-33.png)




DNS Brute Force
```
nmap -p 80 --script dns-brute.nse <Target>
```

![Nmap](https://securityonline.info/wp-content/uploads/2016/11/Screenshot-from-2016-11-11-13-46-43.png)



Find Hosts on IP
```
nmap -p 80 --script hostmap-bfk.nse <Target>
```

Firewalk - Tries to discover firewall rules using an IP TTL expiration technique.
```
nmap --script=firewalk --traceroute --script-args=firewalk.max-retries=1 <Target>
```
![Nmap](https://securityonline.info/wp-content/uploads/2016/11/Screenshot-from-2016-11-11-13-57-22.png)


whois domain
```
nmap --script whois-domain <target>
```
![Nmap](https://securityonline.info/wp-content/uploads/2016/11/Screenshot-from-2016-11-11-14-13-37.png)

Shodan API - API Key can be specieid in args or by editing the NSE script itself (Shown in video)
```
nmap --script shodan-api --script-args 'shodan-api.target=x.y.z.a,shodan-api.apikey=SHODANAPIKEY'
```

<iframe width="650" height="400"src="https://www.youtube.com/embed/WaLrqyNCC8o" frameborder="0" allowfullscreen></iframe>



### Custom NSE Script repositories

Paulino Calderon (cldrn) -
Network security specialist | Open Source contributor | @nmap NSE developer | Chapter leader of @owasp_riviera
```
https://github.com/cldrn/nmap-nse-scripts/tree/master/scripts
```

John Bond -
b4ldr https://www.linkedin.com/in/john-bond-189887a/
```
https://github.com/b4ldr/nse-scripts
```

Peter -
peter-hackertarget  https://hackertarget.com
```
https://github.com/peter-hackertarget/nmap-nse-scripts
```

Sanoop Thomas -
s4n7h0 " Let the passion be your purpose. " Security guy, Researcher, Speaker, Creator of Halcyon IDE
```
https://github.com/s4n7h0/NSE
```

Aeris Secure -
Open source projects from Aeris Secure, mostly relating to information security and security testing
```
https://github.com/aerissecure/nse
```

